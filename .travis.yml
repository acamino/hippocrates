language: ruby
cache:
  bundler: true
rvm:
  - rvm 2.6.3
services:
  - postgresql
addons:
  postgresql: "9.5"

script:
  - bundle exec rubocop
  - RAILS_ENV=test bundle exec rails db:create db:schema:load --trace
  - bundle exec rspec
  - bundle exec cucumber

deploy:
  provider: heroku
  api_key:
    secure: T8S19pZ03HHGBZp7SEZJik8SG3V9ihfxrJW0bFTl5u/m2QumvgB7BRhuZxdXv5tqOGOfgSj5Sicahz/XoKOiVHzoL2WkrS2PnjD3rXl8stbMXpUIpD0+YSfYXfaFJoBqIU2B3Hbfk7HqBS6kyvmDNoCbptfPw46MVodnooUPoVFKaNIfwl8rRg7GlmqRagh2LihwTYirjKLYcj48+XbYLvZ6bIz/aZUnwQx8uYfWOY4fnVh4ShzgxD1HQNZUNKCqN1ovhWeEdVchZRsE0tueRrOD9S6z9EloD2Z2yVBoavbW8k91NYt5ksG6d8ylPSaCDbj8ur7N3lsVYG9lNygQF8BqYQgTbPV/VTGQCfnJyjE2f8aw/Gx0PaKxsXfAevc216zsu7kOz274jw1U53X4w0Bfj5qiWP8GRgAubhjcy5YPMlyPOnA6+WnL4vXj5BLDG1CDEd2bMm5QeeQdAXwiu7eWU9PRBw5oPXIVqo45y/nJ6rZH26SslOUIEwrxTL9M9StWzL0x/jP5/N9LYTXZokpHUeO9WgQlIiwj/LkidRc0T0U/Eyh9c4EOFFDJkd0GqHwX/cZmCOpmw8MZnsKLRP64osWp03D/fqac7T+zYyJt2hEaWAA0D6GJ9zISdSgZ1i6dK4LK9GXfIuWP0JYuTt+WIgCi3+SA+qe8FdRx174=
  run: bundle exec rake db:migrate
  skip_cleanup: true
  on:
    branch:
      - master
